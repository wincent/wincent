#!/bin/bash

set -e

REPO_ROOT="${BASH_SOURCE%/*}/.."

cd "$REPO_ROOT"

source bin/common

log_info "Installing TypeScript"

bin/npm install > /dev/null

log_info "Cleaning"

git clean -fdxq -- fig/types

log_info "Generating TypeScript types"

bin/node support/typegen/index.ts

log_info "Checking TypeScript source"

bin/tsgo

# Hack so that local files can import from 'fig':
ln -fns ../fig node_modules/fig
